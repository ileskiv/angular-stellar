/*! angular-stellar - v 0.2.2 - 2014-01-13T08:28:36.419Z
 * https://github.com/tomchentw/angular-stellar
 * Copyright (c) 2014 [tomchentw](https://github.com/tomchentw/);
 * Licensed [MIT](http://tomchentw.mit-license.org/)
 */
(function(){var t,e,n,o,r,i,s,l,a,f,c,u;t=angular.bind,e=angular.noop,n=angular.extend,o=1e3/60,r=["$window","$log"].concat(function(e,n){var r,i,s,l,a;for(r=["request","webkitRequest","mozRequest","oRequest","msRequest"],i=0,s=r.length;s>i;++i)if(l=r[i],a=e[l+"AnimationFrame"])return t(e,a);return n.warn("Can't find requestAnimationFrame in your browser. Use polyfill."),function(t){return e.setTimeout(t,o)}}),i={scrollProperty:"scroll",positionProperty:"position",horizontalScrolling:!0,verticalScrolling:!0,horizontalOffset:0,verticalOffset:0,hideDistantElements:!0,hideElement:function(t){t.addClass("ng-hide")},showElement:function(t){t.removeClass("ng-hide")},isElementHidden:function(t){return t.hasClass("ng-hide")}},s=function(){function e(t){this._$element=t,this._callbacks=[],this._props={}}e.displayName="Target";var r=e.prototype;return e._lastTime=0,e._targets={},e.getInstance=function(t,n){var o;return(o=this._targets)[t]||(o[t]=new e(n))},e.handleUpdate=function(t){var e,n,r,i,s;if(e=t-this._lastTime<o)return!0;this._lastTime=t,n=!1;for(r in i=this._targets)s=i[r],s.handleUpdate()&&!n&&(n=!0);return n},r.isPropChanged=function(){var t;return t=this.getOffset(),t.scrollTop=this.getTop(),t.scrollLeft=this.getLeft(),angular.equals(t,this._props)?!1:(n(this._props,t),!0)},r.addCallbak=function(e){var n;return n=-1+this._callbacks.push(e),t(this._callbacks,this._callbacks.splice,n)},r.handleUpdate=function(){var t,e,n,o;if(this.isPropChanged())for(t=0,n=(e=this._callbacks).length;n>t;++t)(o=e[t])(this._props)},r.handleWebkitBug=function(){var t,e,n;t=this._props,e=t.scrollTop,n=t.scrollLeft,this.setTop(e+1),this.setLeft(n+1),this.setTop(e),this.setLeft(n)},r.getLeft=function(){return this._$element.prop("scrollLeft")},r.setLeft=function(t){this._$element.prop("scrollLeft",t)},r.getTop=function(){return this._$element.prop("scrollTop")},r.setTop=function(t){this._$element.prop("scrollTop",t)},e}(),l=["$window"].concat(function(t){return function(e,n){var o,r;return o=e[0],r=o.currentStyle?o.currentStyle:t.getComputedStyle?t.getComputedStyle(o):o.style,n?r[n]:r}}),a=["$css"].concat(function(t){var e,n,o,r;e=/^(moz|webkit|khtml|o|ms)(?=[A-Z])/;for(n in t(angular.element("<script></script>")))if(o=n.match(e)){r=o[0];break}return function(t){return r+(r?angular.uppercase(t.charAt(0))+""+t.slice(1):t)}}),f=["$window","$document","$position","$requestAnimationFrame","$css","$vendorPrefix","stellarConfig"].concat(function(e,o,r,i,l,a,f){var c,u,p,h;return c=s.getInstance("window",angular.element(e)),u=s.getInstance("document",o),c.getOffset=u.getOffset=function(){var t;return t=o[0].documentElement,{height:t.clientHeight,width:t.clientWidth,top:0,left:0}},c.getLeft=u.getLeft=function(){return e.pageXOffset},c.getTop=u.getTop=function(){return e.pageYOffset},c.setLeft=u.setLeft=function(t){e.scrollTo(t,e.pageYOffset)},c.setTop=u.setLeft=function(t){e.scrollTo(e.pageXOffset,t)},p=f.scrollProperty,n(s.prototype,{getOffset:function(){return r.offset(this._$element)}},angular.isObject(p)?p:function(){var t,e;switch(t=function(t,e){return parseInt(l(t,e),10)},e=a("transform"),p){case"scroll":return{};case"position":return{getLeft:function(){return-1*t(this._$element,"left")},getTop:function(){return-1*t(this._$element,"top")}};case"margin":return{getLeft:function(){return-1*t(this._$element,"marginLeft")},getTop:function(){return-1*t(this._$element,"marginTop")}};case"transform":return{getLeft:function(){var t;return t=l(this._$element,e),"none"===t?0:-1*parseInt(t.match(/(-?[0-9]+)/g)[4],10)},getTop:function(){var t;return t=l(this._$element,e),"none"===t?0:-1*parseInt(t.match(/(-?[0-9]+)/g)[5],10)}};default:throw Error("unimplemented")}}()),h=t(this,i,function(t){var e;e=s.handleUpdate(t),("scroll"!==p||e)&&h()}),"scroll"===p&&c._$element.on("scroll resize",h),function(t,e){return h()&&s.getInstance(t,e)}}),c=["$window","$position","$css","stellarTarget"].concat(function(t,e,n,o){var r,s;return r=function(t){var e;return e=n(t,"backgroundPosition").split(" "),[parseInt(e[0]),parseInt(e[1])]},s=function(t,e){var o,r;return o=e.stellarBackgroundRatio||1,r="fixed"===n(t,"backgroundAttachment")?0:1,r-o},{restrict:"A",link:function(n,l,a){var f,c,u,p,h,g;f=s(l,a),c=a.stellarVerticalOffset||i.verticalOffset,u=a.stellarHorizontalOffset||i.horizontalOffset,p=e.offset(l),h=r(l),g={top:0,left:0},p.bgTop=h[1],p.bgLeft=h[0],n.$on("$destroy",o("window",t).addCallbak(function(t){var e,n;e=f*(t.scrollTop+c-t.top-p.top+g.top-p.bgTop),n=f*(t.scrollLeft+u-t.left-p.left+g.left-p.bgLeft),l.css("background-position",n+"px "+e+"px")}))}}}),u=["$window","$css","$vendorPrefix","$position","stellarConfig","stellarTarget"].concat(function(t,e,n,o,r,i){var s,l,a,f,c,u;return s=r.positionProperty,l=r.horizontalScrolling,a=r.verticalScrolling,f=angular.isFunction(s.setPosition)?s.setPosition:function(){var t,e,o;switch(t=n("transform"),s){case"position":e=function(t,e){t.css("top",e)},o=function(t,e){t.css("left",e)};break;case"transform":return function(e,n,o,r,i){e.css(t,"translate3d("+(n-o)+"px, "+(r-i)+"px, 0)")};default:throw Error("unimplemented")}return function(t,n,r,i,s){l&&o(t,n+"px",r+"px"),a&&e(t,i+"px",s+"px")}}(),c=function(t){return"fixed"===e(t,"position")},u=function(t,e){var n,o;return n=e.stellarRatio||1,o=c(t)?1:0,n+o-1},{restrict:"A",link:function(e,n,s){var p,h,g,d,m,v,$;p=c(n),h=-1*u(n,s),g=s.stellarVerticalOffset||r.verticalOffset,d=s.stellarHorizontalOffset||r.horizontalOffset,m=o.offset(n),v=o.position(n),$={top:0,left:0},m.positionTop=v.top,m.positionLeft=v.left,e.$on("$destroy",i("window",t).addCallbak(function(t){var e,o,i,s,c,u,v,T,w;e=m.positionTop,o=m.top,a&&(e+=h*(t.scrollTop+g+t.top+m.positionTop-m.top+$.top),o+=e-m.positionTop),i=m.positionLeft,s=m.left,l&&(i+=h*(t.scrollLeft+d+t.left+m.positionLeft-m.left+$.left),s+=i-m.positionLeft),r.hideDistantElements&&(c=p?0:t.scrollLeft,u=p?0:t.scrollTop,v=!l||s+m.width>c&&s<t.width+t.left+c,T=!a||o+m.height>u&&o<t.height+t.top+u),w=r.isElementHidden(n),v&&T?(w&&r.showElement(n),f(n,i,m.positionLeft,e,m.positionTop)):w||r.hideElement(n)}))}}}),angular.module("angular.stellar",["ui.bootstrap.position"]).constant("stellarConfig",i).factory("$requestAnimationFrame",r).factory("$css",l).factory("$vendorPrefix",a).factory("stellarTarget",f).directive("stellarRatio",u).directive("stellarBackgroundRatio",c)}).call(this);